{% extends "layout.html" %}
{% block content %}
<h4 class="fw-bold mb-1">Results: {{ election.title }}</h4>
<p class="text-muted mb-3">
  Total Votes: <b>{{ total_votes }}</b> / Eligible: <b>{{ eligible_total }}</b> |
  Turnout: <b>{{ '%.2f'|format(turnout) }}%</b>
</p>

{% if total_votes == 0 %}
  <div class="alert alert-warning rounded-4 shadow-sm">
    No votes yet. Winner will be shown after voting starts.
  </div>
{% else %}
  {% if winner %}
    <div class="alert alert-success rounded-4 shadow-sm">
      üèÜ Winner: <b>{{ winner.name }}</b> with <b>{{ winner.votes }}</b> votes
    </div>
  {% elif tie_winners and tie_winners|length > 1 %}
    <div class="alert alert-info rounded-4 shadow-sm">
      ü§ù Tie between:
      <b>
        {% for w in tie_winners %}
          {{ w.name }}{% if not loop.last %}, {% endif %}
        {% endfor %}
      </b>
      (each has <b>{{ tie_winners[0].votes }}</b> votes)
    </div>
  {% endif %}
{% endif %}

<div class="card rounded-4 shadow-sm">
  <div class="card-body">
    <table class="table align-middle mb-0">
      <thead>
        <tr>
          <th>Candidate</th>
          <th class="text-end">Votes</th>
        </tr>
      </thead>
      <tbody>
        {% for r in rows %}
          <tr>
            <td class="fw-semibold">{{ r.name }}</td>
            <td class="text-end">{{ r.votes }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<div class="mt-3">
  <a class="btn btn-outline-dark" href="/admin/election/{{ election.id }}">Back</a>
</div>

{% endblock %}